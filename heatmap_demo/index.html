<!DOCTYPE html>
<html>

<head>
    <title>Leaflet.heat demo</title>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
    <style>
        #map {
            width: 800px;
            height: 600px;
        }

        #title_container {
            z-index: 10000;
            position: fixed;
            left: 80px;
        }

        body {
            font: 16px/1.4 "Helvetica Neue", Arial, sans-serif;
        }

        .ghbtns {
            position: relative;
            top: 4px;
            margin-left: 5px;
        }

        a {
            color: #0077ff;
        }
    </style>
</head>

<body>

    <!-- This be very hacky -->

    <p>
        Using <a href="https://github.com/Leaflet/Leaflet.heat">Leaflet.heat</a> to display TLV birds data
        <!-- <iframe class="ghbtns" src="http://ghbtns.com/github-btn.html?user=Leaflet&amp;repo=Leaflet.heat&amp;type=watch&amp;count=true"
            allowtransparency="true" frameborder="0" scrolling="0" width="90" height="20"></iframe> -->
    </p>

    <div id="title_container">
        <h2 id="clock">Time</h2>
    </div>

    <div id="map"></div>

    <script src="./leaflet-heat.js"></script>
    <script src="./heatmap_timeline.js"></script>
    <script src="./dates.js"></script>

    <script>

        var map = L.map('map').setView([32.0795, 34.7812], 14);

        var tiles = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
        }).addTo(map);

        birdpoints = birdpoints.map(x => x.map(y => [y[0], y[1], 2]));

        var heat = L.heatLayer(birdpoints[0], { radius: 30 }).addTo(map);
        var clock = document.getElementById("clock");

        let i = 40;
        setInterval(() => {
            heat.setLatLngs(birdpoints[i]);
            clock.innerHTML = 'Time ' + getTimefromMillis(dates[i]);
            i++

            if (i == birdpoints.length - 1) {
                i = 0;
            }

        }, 100)

        function getTimefromMillis(timestamp) {
            let date = new Date(timestamp);
            let minutes = date.getMinutes();
            minutes = minutes > 9 ? minutes : '0'+minutes;
            return date.getHours() + ':' + minutes; 
        }

    </script>
</body>

</html>